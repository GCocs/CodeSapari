<!DOCTYPE html>
<html lang="ko">
  <head>
    <!-- ë‹¤ì–‘í•œ ì–¸ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ UTF-8ì„ ì‚¬ìš©í•˜ë„ë¡ í•©ë‹ˆë‹¤. -->
    <meta charset="UTF-8" />

    <!-- ë°˜ì‘í˜•ìœ¼ë¡œ ë™ì‘í•˜ê²Œ í•©ë‹ˆë‹¤. -->
    <meta title="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bootstrapê³¼ jQueryë¥¼ í¬í•¨í•©ë‹ˆë‹¤. -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
      integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N"
      crossorigin="anonymous"
    />
    <script
		  src="https://code.jquery.com/jquery-3.5.1.min.js"
		  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
		  crossorigin="anonymous"
		></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
      crossorigin="anonymous"
    ></script>

    <!-- CSS libraryì¸ Bulmaë¥¼ í¬í•¨í•©ë‹ˆë‹¤. -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css"
    />

    <!-- í…ìŠ¤íŠ¸ í˜•íƒœë¡œ ë˜ì–´ìˆëŠ” iconì„ ì“¸ ìˆ˜ ìˆë„ë¡ Font awesomeì„ í¬í•¨í•©ë‹ˆë‹¤. -->
    <script
      defer
      src="https://use.fontawesome.com/releases/v6.4.0/js/all.js"
    ></script>

    <title>ë§ˆì´ í˜ì´ë³´ë¦¿ ë¬´ë¹„ | í”„ë¡ íŠ¸-ë°±ì—”ë“œ ì—°ê²° ë§ˆì§€ë§‰ ì˜ˆì œ!</title>

    <!-- ì´ HTML ì•ˆì—ì„œ ì‚¬ìš©í•  CSSë¥¼ ì •ì˜í•©ë‹ˆë‹¤. -->
    <!-- .ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë‹¨ì–´ëŠ” CSS classì— í•´ë‹¹í•˜ë©° .ì„ ì œì™¸í•œ ì´ë¦„ì„ HTML tagì—ì„œ class="..." í˜•íƒœë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. -->
    <!-- ì˜ˆ: <div class="center"> -->
    <style>
      .center {
        text-align: center;
      }

      .button-temp {
        margin-left: 2.5%;
        margin-right: 2.5%;
        width: auto;
        box-sizing: border-box;
        border-radius: 50px;
        font-size: 25px;
        font-weight: 700;
        border:2px solid #f16def;
        color:#f16def;
      }
      .button-favorite {
        width: auto;
        box-sizing: border-box;
        border-radius: 50px;
        font-weight: 700;
        border:2px solid #f16def;
        color:#f16def;
      }
      .button-delete {
        width: auto;
        box-sizing: border-box;
        border-radius: 50px;
        font-weight: 700;
        border:2px solid #5877f9;
        color:#5877f9;
      }


        table {
            border: 1px #a39485 solid;
            font-size: .9em;
            box-shadow: 0 2px 5px rgba(0,0,0,.25);
            width: 90%;
            border-collapse: collapse;
            border-radius: 5px;
            overflow: hidden;
            margin-left: 5%;
        }

        th {
            text-align: left;   
        }
        
        thead {
            font-weight: bold;
            color: #fff;
            background: #73685d;
        }
        
        td, th {
            padding: 1em .5em;
            vertical-align: middle;
        }
        
        td {
            border-bottom: 1px solid rgba(0,0,0,.1);
            background: #fff;
        }

        a {
            color: #73685d;
        }
    </style>

    <!-- ì´ HTMLì—ì„œ ì‚¬ìš©í•  ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. -->
    <script>
      function go_main() {
        window.location.href = "/";
      }

      function favorite(id) {
        $.ajax({
            type: "POST",
            url: "/api/favorite",
            data: {"id" : id},
            success: function (response) {
                alert("ì¦ê²¨ì°¾ê¸° ë˜ì—ˆìŠµë‹ˆë‹¤!");
                showMovie();
            },
        });
      }

      function delete_movie(id) {
        $.ajax({
            type: "POST",
            url: "/api/delete",
            data: {"id" : id},
            success: function (response) {
                alert("ì‚­ì œ ë˜ì—ˆìŠµë‹ˆë‹¤!");
                showMovie();
            },
        });
      }

      $(document).ready(function () {
        showMovie();
      });

      function showMovie() {
        $("#movie-table").empty();

        $.ajax({
            type: "GET",
            url: "/api/temp_list",
            data: {},
            success: function (response) {
              if (response["result"] !== "success") {
                alert(sortMode + " ìˆœìœ¼ë¡œ ì˜í™” ëª©ë¡ ë°›ì•„ì˜¤ê¸° ì‹¤íŒ¨!");
                return;
              }
              let movies = response["movies_list"];
              addMovieCards(movies, true);
            },
        });
      }

      function addMovieCards(movies, tempMode) {
        // for ë¬¸ì„ í™œìš©í•˜ì—¬ movies ë°°ì—´ì˜ ìš”ì†Œë¥¼ ì°¨ë¡€ëŒ€ë¡œ ì¡°íšŒí•©ë‹ˆë‹¤.
        for (let i = 0; i < movies.length; i++) {
          let movie = movies[i];

          // 1. movie[i] ìš”ì†Œì˜ title, running_time, pg_level, img_src, released_year, likes í‚¤ ê°’ì„ í™œìš©í•˜ì—¬ ê°’ì„ ì¡°íšŒí•©ë‹ˆë‹¤.
          let id = movie["_id"];
          let title = movie["title"];
          let running_time = movie["running_time"];
          let likes = movie["likes"];
          let released_year = movie["released_year"];

          let movieTable = `
                        <tr>
                            <td>${title}</td>
                            <td><i class="fas fa-thumbs-up ml-3 mr-1"></i>${likes}</td>
                            <td>${running_time}ë¶„</td>
                            <td>${released_year}ë…„</td>
                            <td>
                                <button class="button-favorite" onclick="favorite('${id}')">
                                    í˜ì´ë³´ë¦¿
                                </button>
                                <button class="button-delete" onclick="delete_movie('${id}')">
                                    ì˜êµ¬ì‚­ì œ
                                </button>
                            </td>
                        </tr>
          `;

          $("#movie-table").append(movieTable);

         
        }
      }
    </script>
  </head>

  <!-- HTML ë³¸ë¬¸ì— í•´ë‹¹í•©ë‹ˆë‹¤. -->
  <!-- HTML íƒœê·¸ë¥¼ ì´ìš©í•´ì„œ layoutì„ ëŒ€ëµì ìœ¼ë¡œ ì¡ì•„ë‘ê³ , -->
  <!-- ìœ„ì— ì •ì˜ëœ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ë™ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¡°ì‘í•´ ìµœì¢… HTML ì´ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. -->
  <body>
    <!-- ì œëª© ë¶€ë¶„ -->
    <section class="hero is-warning">
      <div class="hero-body">
        <div class="container center">
          <h1 class="title">ë§ˆì´ í˜ì´ë³´ë¦¿ ë¬´ë¹„ğŸ˜†</h1>
          <h2 class="subtitle">ìˆœìœ„ë¥¼ ë§¤ê²¨ë´…ì‹œë‹¤</h2>
          <button class="button-temp" onclick="go_main()">í˜ì´ë³´ë¦¿ ê°€ê¸°</button>
        </div>
      </div>
    </section>

    <hr>

    <table>
        <thead>
        <tr>
            <th>ì œëª©</th>
            <th>ì¶”ì²œ ìˆ˜</th>
            <th>ìƒì˜ì‹œê°„</th>
            <th>ê°œë´‰ì—°ë„</th>
            <th>ê¸°ëŠ¥</th>
    
        </tr>
        </thead>
        <tbody id="movie-table">
        </tbody>
    </table>

  </body>
</html>